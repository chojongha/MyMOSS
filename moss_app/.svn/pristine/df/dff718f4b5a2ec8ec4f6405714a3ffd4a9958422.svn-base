var transOfficeDetail_debugPrefix = "[transOffice_detail.js] : ";

//국사 상세 페이지 출력
function showTransOffice_detail(){
	
	$.mobile.loading( "show", {
        text: "로딩중...",
        textVisible: true,
        theme: "a",
        html: ""
	}); 
	
// 국사정보 뿌려줄 파라미터 값 받기. 인풋에 넣어줘야함.
	
	$.ajax({
		url: url + "ManualDetail",
		type: "post",
		timeout: 10*1000,
		dataType: "json",
		data: {manualSeqNum: '1'},		
		success: function(result){
			var bodyData = result.body;
			var headerData = result.header;
			
			if(headerData.result != 0){
				$.mobile.hidePageLoadingMsg();
				showCommonAlert("에러", headerData.errMsg);
			}else{
				$.each(bodyData, function(key, val){
					//테이블 생성
					var transOfficeTB ='<table class="basic" id="table_detail">'+
										'<tr>'+
										'<th align="left" colspan="2">국사정보</th>	'+				
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">고유정보</td>'+
										'<td align="left" id="TO_info"></td>'+  	// TO는 Trans Office
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">시설형태</td>'+
										'<td align="left" id="TO_facilForm"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">국사명</td>'+
										'<td align="left" id="TO_area"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">사진정보</td>'+
										'<td align="left" id="TO_pic">사진보기&nbsp;<a href="#TO_img" data-rel="popup" data-position-to="window" data-transition="fade"><img class="popphoto" src="../img/viewTO.png" style="width:1.5em; height:1.5em;"></a></td>'+
										'</tr>'+
										//이미지 클릭시 국사사진 팝업띄우기											
										'<tr>'+
										'<th align="left" colspan="2">위치정보</th>	'+				
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">주소</td>'+
										'<td align="left" id="TO_addr"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">상세정보</td>'+
										'<td align="left" id="TO_detailAddr"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">위도</td>'+
										'<td align="left" id="TO_lat"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">경도</td>'+
										'<td align="left" id="TO_longi"></td>'+
										'</tr>'+
											
										'<tr>'+
										'<th align="left" colspan="2">출입정보</th>'+				
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">제한시간</td>'+
										'<td align="left" id="TO_timeLimit"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">출입방법</td>'+
										'<td align="left" id="TO_visitRule"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">건물관리자</td>'+
										'<td align="left" id="TO_manager"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">건물전화</td>'+
										'<td align="left" id="TO_tel"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">건물 관리자 휴대전화</td>'+
										'<td align="left" id="TO_manaPhone"></td>'+
										'</tr>'+
											
										'<tr>'+
										'<th align="left" colspan="2">시설정보</th>	'+				
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">장비내역 1</td>'+
										'<td align="left" id="TO_equiHistory1"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">장비내역 2</td>'+
										'<td align="left" id="TO_equiHistory2"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">장비내역 3</td>'+
										'<td align="left" id="TO_equiHistory3"></td>'+
										'</tr>'+
													
										'<tr>'+
										'<th align="left" colspan="2">관리정보</th>'+					
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">관할센터</td>'+
										'<td align="left" id="TO_jurisCenter"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">관할운용팀</td>'+
										'<td align="left" id="TO_jurisTeam"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">무선운용단</td>'+
										'<td align="left" id="TO_wirelessGroup"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">무선운용팀</td>'+
										'<td align="left" id="TO_wirelessTeam"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">유지보수사</td>'+
										'<td align="left" id="TO_maintenance"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">담당(정)</td>'+
										'<td align="left" id="TO_charge"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">연락처(정)</td>'+
										'<td align="left" id="TO_chargeTel"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">담당(부)</td>'+
										'<td align="left" id="TO_subCharge"></td>'+
										'</tr>'+
										'<tr>'+
										'<td align="left" width="40%">연락처(부)</td>'+
										'<td align="left" id="TO_subChargeTel"></td>'+
										'</tr>'+
										'</table>';
					//테이블 삽입								
					$("#table_transOfficeDetail").html(transOfficeTB); 					
					//데이터 세팅			
					$('#TO_info').text(val.MANUALSEQNUM);
					$('#TO_facilForm').text(val.SERVICEIDNAME);
					$('#TO_area').text(val.SERVICEID);
					$('#TO_addr').text(val.SUBJECT);
					$('#TO_detailAddr').text(val.CONTENT);
					$('#TO_lat').text(val.READCNT);
					$('#TO_longi').text(val.WRITEDATE);
					$('#TO_timeLimit').text(val.WRITEDATE);
					$('#TO_visitRule').text(val.FILENAME);
					$('#TO_manager').text(val.WRITERNAME);
					$('#TO_tel').text(val.ATTACHSEQNUM);
					$('#TO_manaPhone').text(val.ATTACHSEQNUM);
					$('#TO_equiHistory1').text(val.FILESIZE);
					$('#TO_equiHistory2').text(val.FILESIZE);
					$('#TO_equiHistory3').text(val.FILESIZE);
					$('#TO_jurisCenter').text(val.SERVICESUBIDNAME);
					$('#TO_jurisTeam').text(val.SERVICESUBIDNAME);
					$('#TO_wirelessGroup').text(val.SERVICESUBIDNAME);
					$('#TO_wirelessTeam').text(val.SERVICESUBIDNAME);
					$('#TO_maintenance').text(val.SERVICESUBIDNAME);
					$('#TO_charge').text(val.WRITERNAME);
					$('#TO_chargeTel').text(val.REGISTDATE);
					$('#TO_subCharge').text(val.WRITERNAME);
					$('#TO_subChargeTel').text(val.REGISTDATE); 
				});
			}
			$.mobile.hidePageLoadingMsg();	
		},
		error: function(jqXHR, textStatus, errorThrown) {
			console.log(transOfficeDetail_debugPrefix + "국사상세정보 출력 에러 : " + jqXHR.status);
	        console.log(transOfficeDetail_debugPrefix + "국사상세정보 출력 에러 : " + jqXHR.responseText);
			console.log(transOfficeDetail_debugPrefix + "국사상세정보 출력 에러 : " + errorThrown);
	    }
	});
}

//국사 사진보기
function showTransOfficeImg(){
	$.ajax({
		url: url + "WorkOdrList",
		type: "post",
		timeout: 10*1000,
		dataType: "json",
		data: {workerID: 'qtest'},
		
		success: function(result){
			var bodyData = result.body;
			
			$.each(bodyData, function(key, val){
								 
				var imgPop = '<div data-role="popup" id="TO_img" data-overlay-theme="a" data-theme="d" data-corners="false">'+
							 '<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a><img id="imgSrc" class="popphoto" src="../img/transOfficePhoto.png" style="max-height:512px;" alt="국사사진">'+
							 '</div>';
				
				$("#table_transOfficeDetail").append(imgPop).trigger("create");										
			});
		},
		error: function(jqXHR, textStatus, errorThrown) {
			console.log(transOfficeDetail_debugPrefix + "국사사진 출력 에러 : " + jqXHR.status);
	        console.log(transOfficeDetail_debugPrefix + "국사사진 출력 에러 : " + jqXHR.responseText);
			console.log(transOfficeDetail_debugPrefix + "국사사진 출력 에러 : " + errorThrown);
	    }
	});
}

$(document).on("pagebeforeshow","#page_transOffice_detail",function(event){
////	showTransOffice_detail();
});

$(document).on("pageshow","#page_transOffice_detail",function(event){
//	showTransOffice_detail();
//	showTransOfficeImg();
});
