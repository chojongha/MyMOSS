var notice_Detail_debugPrefix = "[board_notice_detail.js] : ";


function testURL(str) {
	
	alert("call");
	
	if(device.platform == "Android"){
		location.href = url + str;
	} else {
		window.open(url + str, '_blank', 'EnableViewPortScale=yes');
	}
}


function showNoticeDetail(){
    

    
    $.mobile.loading( "show", {
          text: "리스트를 읽어오는 중 입니다.",
          textVisible: true,
          theme: "a",
          html: ""
    }); 
    
    noticeSN=Request("noticeSeqNum");
    
    console.log(notice_Detail_debugPrefix + "넘어온 시퀀스넘버 = " + noticeSN);
    
    $.ajax({
        url: url+"NoticeDetail",        
        type: "post",
        timeout : 10 * 1000,
        dataType : "json",
        data: {noticeSeqNum : noticeSN}, //인풋(접속)
        
        
        success: function (result) {
            var bodyData = result.body; //아웃풋 정보 가져오기
            
            $.each(bodyData, function(key, val){ //아웃풋 뿌리기
                
                $.each(val, function(key, val) {
                    console.log(notice_Detail_debugPrefix + key + " : " + val);
                });
                
                var noticeDetailTB ="<table>"+
                "<tr>"+ 
                "<td>제 목</td>"+
                "<td colspan='3' id='notice_title'></td>"+
                "</tr>"+
                "<tr>"+
                "<td>작성일시</td>"+
                "<td colspan='3' id='notice_writeDate'></td>"+
                "</tr>"+                           
                "<tr>"+
                "<td width='20%'>작 성 자</td>"+
                "<td width='30%' id='notice_writer'></td>"+
                "<td width='20%'>조 회 수</td>"+
                "<td width='30%' id='notice_viewCount'></td>"+
                "</tr>"+   
                "<tr>"+
                "<td colspan='4' id='notice_content' width='50' height='400' valign='top'></td>"+
                "</tr>"+
                "<tr>"+
                "<td width='20%'>첨부파일</td>"+
                "<td colspan='3' id='notice_file'>" +
                "</tr>"+
                "</table>";                          
                var noticeCon = "<div id='contents' style='overflow-y:auto; width:100%; height:100%; padding:4px'><div>";
              
                console.log(notice_Detail_debugPrefix + "첨부파일 일련번호 : " + val.ATTACHSEQNUM);
                console.log(notice_Detail_debugPrefix + "content : " + val.CONTENT);
                
                //본문 테이블 넣기                                                                             
                $('#notice_table').html(noticeDetailTB);                
                $('#notice_content').html(noticeCon);
                //본문 데이터 세팅             
                $('#notice_title').text(val.SUBJECT);
                $('#notice_writeDate').text(val.WRITEDATE);
                $('#notice_writer').text(val.WRITERNAME);
                $('#notice_viewCount').text(val.READCNT);
                $('#contents').text(val.CONTENT);
                
                console.log(notice_Detail_debugPrefix + "content : " +  $('#contents').val(val.CONTENT));
                if(val.FILENAME==null){
                    $('#notice_file').text("없음");
                }else{
                  
//                    if(val.FILENAME.length > 20){
//                        if(device.platform == "Android"){
                        $('#notice_file').append(val.FILENAME.substr(0,20)+ "..." + "<img class='fileDown' src='../img/download.png' style='width:1.5em; height:1.5em;' onclick=testURL('filedownload?attachSeqNum="+ val.ATTACHSEQNUM +"');>");
//                        }else{
//                            $('#notice_file').append(val.FILENAME.substr(0,20)+ "..." + "<img class='fileDown' src='../img/download.png' style='width:1.5em; height:1.5em;' onclick='test(filedownload?attachSeqNum="+ val.ATTACHSEQNUM +");'>");
//                        }
//                        }else{
//                            if(device.platform == "Android"){
//                        $('#notice_file').append(val.FILENAME + "<a href='" + url + "filedownload?attachSeqNum="+ val.ATTACHSEQNUM +"' id='notice_file'><img class='fileDown' src='../img/download.png' style='width:1.5em; height:1.5em;'></a>");
//                        }else{
//                            $('#notice_file').append(val.FILENAME + "<a href='http://10.217.76.186:8081/moss/filedownload?attachSeqNum=37, '_blank', 'EnableViewPortScale=yes' id='notice_file'><img class='fileDown' src='../img/download.png' style='width:1.5em; height:1.5em;'></a>");
//                        }   
//                        }
                    
                     }
                $.mobile.hidePageLoadingMsg();
            });
        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(notice_Detail_debugPrefix + "매뉴얼 상세화면 출력 에러 : " + jqXHR.status);
            console.log(notice_Detail_debugPrefix + "매뉴얼 상세화면 출력 에러 : " + jqXHR.responseText);
            console.log(notice_Detail_debugPrefix + "매뉴얼 상세화면 출력 에러 : " + errorThrown);
        }
    }); 
}   


    
$(document).on("pagebeforeshow","#page_notice_detail",function(event){
    //showManualDetail();
}); 
$(document).on("pageshow","#page_notice_detail",function(event){
    showNoticeDetail();
}); 