var alarmList_noti_detail_contact_debugPrefix = "[alarmList_noti_detail_contact.js] : ";

var commonShowConfirm = function(number) {
    function onConfirm(button) {
        if(button == 2) {
            location.href = "tel:" + number;
        }
    }
    navigator.notification.confirm(
        number, // message
        onConfirm, // callback to invoke with index of button pressed
        '전화연결', // title
        '취소,확인'
    );
};

function call_Test(number){
    if ( number == undefined || number == null || number == "" ) return;
        
    commonShowConfirm(number);
}



function showcontactList(){
    // 페이지가 보여지면서 로더를 보여준다.
    $.mobile.loading( "show", {
          text: "리스트를 읽어오는 중 입니다.",
          textVisible: true,
          theme: "a",
          html: ""
    });
    
       notisq=notiseqnum; 
      
       console.log(alarmList_noti_detail_contact_debugPrefix + "넘어온 시퀀스넘버 = " + notisq);
    
    $.ajax({
        url: url+"FaultNotiContactNumber",        
        type: "post",
        timeout : 10 * 1000,
        dataType : "json",
        data: {notiseqnum : notisq}, //인풋(접속)
        
        
        success: function (result) {
            var bodyData = result.body; //아웃풋 정보 가져오기
            var contactli="";
            
            if(bodyData.length > 0){
            $.each(bodyData, function(key, val){ //아웃풋 뿌리기
                
                $.each(val, function(key, val) {
                    console.log(alarmList_noti_detail_contact_debugPrefix + key + " : " + val);
                });
                    
                   
                contactli +=        "<li data-icon='false' onclick=\"javascript:call_Test('"+ val.PHONENUMBER +"');\">" +
                                    //"<a href=\"javascript:call_Test('"+ val.PHONENUMBER +"');\" id='btn_call'>" +
                                    "<table id='dynamicList' >" +
                                    "<tr>" +
                                    "<td class='dynamicTable_td'><h2 style='display:inline-block;'>"+ val.USER_NM +"</h2></td>" +
                                    "</tr>" +
                                    "<tr>" +
                                    "<td class='dynamicTable_td'>전화번호 : "+ val.PHONENUMBER +"</td>" +
                                    "<td class='dynamicTable_td' align='right'>"+ val.DEPARTMENT_NAME +"</td>" +
                                    "</tr>" +
                                    "</table>" +
                                    //"</a>" +
                                    "</li>";
                 


                });
            }else{
                contactli = "<li data-icon='false'> "+
                           "    <a href='#'>" +
                           "        <center><h2>데이터가 존재하지 않습니다.</h2></center>" +
                           "    </a>" +
                           "</li>";
            }
            $('#contactList').append(contactli).listview("refresh");
            $.mobile.hidePageLoadingMsg();
        },
        error: function(jqXHR, textStatus, errorThrown){
            console.log(alarmList_noti_detail_contact_debugPrefix + "매뉴얼리스트 출력 에러 : " + jqXHR.status);
            console.log(alarmList_noti_detail_contact_debugPrefix + "매뉴얼리스트 출력 에러 : " + jqXHR.responseText);
            console.log(alarmList_noti_detail_contact_debugPrefix + "매뉴얼리스트 출력 에러 : " + errorThrown);
        } 
    });
}   

$(document).on("pageshow","#page_contact_list", function(event){
    
    showcontactList();

});



